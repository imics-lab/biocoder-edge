# -----------------------------------------------------------------------------
# BioCoder-Edge: Main Configuration File
# -----------------------------------------------------------------------------
# This file contains all the tunable parameters for the application.
# Edit these values to match your specific hardware and server setup.
# -----------------------------------------------------------------------------

# =============================================================================
# Module A: Motion Detector Configuration
# =============================================================================
motion_detector:


  blur_kernel_size: [21, 21]
  # The width (in pixels) to which frames are resized for motion analysis.
  # Smaller values are faster but less sensitive to small movements.
  motion_frame_width: 640

  # The minimum pixel area of a moving object to be considered significant.
  # This helps filter out noise like insects, leaves, or sensor noise.
  min_motion_contour_area: 500

  # The duration in seconds to continue recording after motion has stopped.
  # This ensures the full event is captured if an animal pauses briefly.
  motion_cooldown_seconds: 10.0

# =============================================================================
# Module B: Animal Analyzer Configuration
# =============================================================================
animal_analyzer:

  device_id: "YOUR_DEVICE_ID"

  location:
    latitude:  YOUR_LATITUDE    # Replace with your actual latitude
    longitude: YOUR_LONGITUDE   # Replace with your actual longitude

  output_fps: 30.0  # The FPS for output video files. Adjust based on your needs.

  # The file path to the trained YOLO model weights (e.g., .pt file).
  yolo_model_path: "model_weight/best.pt"

  # A list of class names that are considered significant events.
  # If YOLO detects any of these, the event will be saved and uploaded.
  # Names must match the class names in your YOLO model.
  species_of_interest:
    - 'Deer'
    - 'Rabbit'
    - 'Squirrel'
    - 'Vulture'

  tracking_max_distance: 75

  # The minimum confidence score (0.0 to 1.0) for a YOLO detection to be considered.
  confidence_threshold: 0.4

  event_confirmation_frames: 5         
  tracking_inactivity_frames: 10 


  # The maximum number of full-resolution frames to hold in RAM at one time.
  # If an event is longer than this, frames will be temporarily written to disk
  # to prevent running out of memory.
  ram_frame_limit: 300

  # The local directory where final video/JSON packages are placed before upload.
  # This path should be relative to the project root or an absolute path.
  output_pending_dir: "data/pending_upload/"

  # A directory for storing temporary video parts for very long events.
  # This should be a path with fast I/O if possible (like /tmp).
  output_temp_dir: "/tmp/biocoder_edge_temp/"

# =============================================================================
# Module C: Data Uploader Configuration
# =============================================================================
uploader:
  # The interval in seconds for the uploader to scan the pending directory for new files.
  scan_interval_seconds: 60 # (300 seconds = 5 minutes)

  # --- SFTP Server Configuration (for file transfer) ---
  sftp:
    # IP address or hostname of your remote cloud server.
    host: "YOUR_SFTP_HOST"
    
    # SFTP port number (usually 22).
    port: 22
    
    # The username for the SFTP connection.
    username: "YOUR_SFTP_USERNAME"
    
    # The absolute path to the private SSH key for passwordless authentication.
    # Highly recommended over using passwords.
    ssh_key_path: "/path/to/your/ssh/private/key"
    
    # The absolute path on the remote server where video files should be stored.
    # The SFTP user must have write permissions to this directory.
    remote_video_dir: "/path/to/remote/video/directory"
    
    # The absolute path on the remote server where JSON metadata files should be stored.
    remote_json_dir: "/path/to/remote/json/directory"

  # --- PostgreSQL Database Configuration ---
  database:
    # IP address or hostname of your database server. Can be the same as SFTP host.
    host: "YOUR_DB_HOST"
    
    # PostgreSQL port number (usually 5432).
    port: 5432
    
    # The name of the database to connect to.
    dbname: "YOUR_DATABASE_NAME"
    
    # The username for the database connection.
    user: "YOUR_DB_USERNAME"
    
    # The password for the database user.
    # For production, consider using more secure methods like environment variables.
    password: "YOUR_DB_PASSWORD"

# =============================================================================
# Live View Configuration (Optional)
# =============================================================================
live_view:
  # Set to true to enable the live view functionality. The MotionDetector will
  # check for the lock file and write frames if it exists.
  enabled: true
  
  # The path on the RAM disk where the latest frame will be written as a JPEG.
  # /dev/shm is a standard RAM disk on most Linux systems.
  ram_disk_path: "/dev/shm/live_frame.jpg"
  
  # The path to the lock file that signals an active viewer.
  # The stream_server.py will create and delete this file.
  lock_file_path: "/dev/shm/viewer_active.lock"